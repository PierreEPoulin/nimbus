{
  "version": 3,
  "sources": ["../src/tableaux.ts"],
  "sourcesContent": ["export type TableauItem = {\n    className: string;\n    audioStartUrl: string | undefined;\n    audioStart: Howl | undefined;\n};\n\n\nconst TABLEAU_CLASS: string = 'tableaux__wrapper';\n\nexport class Tableau {\n    items: TableauItem[] = [];\n\n    constructor() {\n        this.buildStack();\n    }\n\n    private shuffleArray(array: TableauItem[]): TableauItem[] {\n        for (let i = array.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [array[i], array[j]] = [array[j], array[i]];\n        }\n        return array;\n    }\n\n    private buildStack(): void {\n\n        console.log(\"Building MIR stack\");\n\n        const parentClass = TABLEAU_CLASS;\n\n        const parentElement: HTMLElement | null = document.querySelector(`.${parentClass}`);\n        if (!parentElement) {\n        console.error('Parent element not found');\n        return;\n        }\n\n        const children: HTMLCollection = parentElement.children;\n        let items: TableauItem[] = [];\n        const MAX_ITEMS: number = 100;\n\n        Array.from(children).slice(0, MAX_ITEMS).forEach((child: Element) => {\n            const className: string = child.classList[0] || \"\";\n            let audioUrl: string | undefined = undefined; // Default to undefined\n            let howl: Howl | undefined = undefined;\n\n            // Constrain items by count, if desired for testing\n            if(items.length >= MAX_ITEMS) return;\n\n            const mirBreakpoint = child.getAttribute('mir-breakpoint');\n            const isDesktopOrTablet = window.innerWidth >= 992; // Example breakpoint for desktop/tablet\n            const isMobile = window.innerWidth < 992; // Example breakpoint for mobile\n          \n            if ((mirBreakpoint === 'desktop' && !isDesktopOrTablet) || \n                (mirBreakpoint === 'mobile' && !isMobile)) {\n                    console.log(\"skipped\", child, className); \n              return; // Skip adding this item\n            }\n\n            // Constrain items by type, if desired for testing\n//            if(!className.startsWith('in')) return; \n            // if (child.hasAttribute('mir-breakpoint')) {\n\n            // }\n\n\n\n            // Check for the custom attribute 'mir-audio-start'\n            if (child.hasAttribute('mir-audio-start')) {\n                audioUrl = child.getAttribute('mir-audio-start') || undefined;\n\n                // If an audio is specified, preload it\n                if(audioUrl) { \n                    howl = new Howl({\n                        src: [audioUrl],\n                        autoplay: false,\n                        preload: true,\n                        loop: true, \n                        rate: 5,\n                        onload: function () {\n                            (howl as Howl).rate(1);\n                        },\n                        onloaderror: function (error) {\n                            console.error(\"Error loading audio start:\", audioUrl, error);\n                        }\n                    });\n                }\n            }\n        \n            items.push({ className, audioStartUrl: audioUrl, audioStart: howl });\n        });\n                \n        // Array.from(children).slice(0, maxItems).forEach((child: Element) => {\n        //     // Example: Extract className and construct an audioUrl. Modify as needed.\n        //     const className: string = child.classList[0] || \"\";\n        //     const audioUrl: string = `path/to/audio/${className}.mp3`;\n        //     items.push({ className, audioUrl });\n        // });\n\n        this.items = this.shuffleArray(items);\n\n        console.log(this.items);\n    }\n\n    pop(): TableauItem | undefined {\n\n        // Rebuild stack if empty\n        if (this.items.length == 0)\n            this.buildStack();\n\n        return this.items.pop();\n    }\n}"],
  "mappings": ";;AAOA,MAAM,gBAAwB;AAEvB,MAAM,UAAN,MAAc;AAAA,IAGjB,cAAc;AAFd,mBAAuB,CAAC;AAGpB,WAAK,WAAW;AAAA,IACpB;AAAA,IAEQ,aAAa,OAAqC;AACtD,eAAS,IAAI,MAAM,SAAS,GAAG,IAAI,GAAG,KAAK;AAC3C,cAAM,IAAI,KAAK,MAAM,KAAK,OAAO,KAAK,IAAI,EAAE;AAC5C,SAAC,MAAM,IAAI,MAAM,EAAE,IAAI,CAAC,MAAM,IAAI,MAAM,EAAE;AAAA,MAC1C;AACA,aAAO;AAAA,IACX;AAAA,IAEQ,aAAmB;AAEvB,cAAQ,IAAI,oBAAoB;AAEhC,YAAM,cAAc;AAEpB,YAAM,gBAAoC,SAAS,cAAc,IAAI,aAAa;AAClF,UAAI,CAAC,eAAe;AACpB,gBAAQ,MAAM,0BAA0B;AACxC;AAAA,MACA;AAEA,YAAM,WAA2B,cAAc;AAC/C,UAAI,QAAuB,CAAC;AAC5B,YAAM,YAAoB;AAE1B,YAAM,KAAK,QAAQ,EAAE,MAAM,GAAG,SAAS,EAAE,QAAQ,CAAC,UAAmB;AACjE,cAAM,YAAoB,MAAM,UAAU,MAAM;AAChD,YAAI,WAA+B;AACnC,YAAI,OAAyB;AAG7B,YAAG,MAAM,UAAU;AAAW;AAE9B,cAAM,gBAAgB,MAAM,aAAa,gBAAgB;AACzD,cAAM,oBAAoB,OAAO,cAAc;AAC/C,cAAM,WAAW,OAAO,aAAa;AAErC,YAAK,kBAAkB,aAAa,CAAC,qBAChC,kBAAkB,YAAY,CAAC,UAAW;AACvC,kBAAQ,IAAI,WAAW,OAAO,SAAS;AAC7C;AAAA,QACF;AAWA,YAAI,MAAM,aAAa,iBAAiB,GAAG;AACvC,qBAAW,MAAM,aAAa,iBAAiB,KAAK;AAGpD,cAAG,UAAU;AACT,mBAAO,IAAI,KAAK;AAAA,cACZ,KAAK,CAAC,QAAQ;AAAA,cACd,UAAU;AAAA,cACV,SAAS;AAAA,cACT,MAAM;AAAA,cACN,MAAM;AAAA,cACN,QAAQ,WAAY;AAChB,gBAAC,KAAc,KAAK,CAAC;AAAA,cACzB;AAAA,cACA,aAAa,SAAU,OAAO;AAC1B,wBAAQ,MAAM,8BAA8B,UAAU,KAAK;AAAA,cAC/D;AAAA,YACJ,CAAC;AAAA,UACL;AAAA,QACJ;AAEA,cAAM,KAAK,EAAE,WAAW,eAAe,UAAU,YAAY,KAAK,CAAC;AAAA,MACvE,CAAC;AASD,WAAK,QAAQ,KAAK,aAAa,KAAK;AAEpC,cAAQ,IAAI,KAAK,KAAK;AAAA,IAC1B;AAAA,IAEA,MAA+B;AAG3B,UAAI,KAAK,MAAM,UAAU;AACrB,aAAK,WAAW;AAEpB,aAAO,KAAK,MAAM,IAAI;AAAA,IAC1B;AAAA,EACJ;",
  "names": []
}
